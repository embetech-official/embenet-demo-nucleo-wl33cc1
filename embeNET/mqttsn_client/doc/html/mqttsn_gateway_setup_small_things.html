<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>embeNET MQTT-SN Client: MQTT-SN Gateway setup using MQTT For Small Things</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">embeNET MQTT-SN Client<span id="projectnumber">&#160;1.1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('mqttsn_gateway_setup_small_things.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<div><div class="header">
  <div class="headertitle"><div class="title">MQTT-SN Gateway setup using MQTT For Small Things</div></div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#autotoc_md6">Introduction</a></li>
<li class="level1"><a href="#autotoc_md7">Step 1: Download and run the gateway software</a></li>
<li class="level1"><a href="#autotoc_md8">Step 2: Configure the gateway</a></li>
<li class="level1"><a href="#autotoc_md9">Step 3: Verify the gateway (optional)</a><ul><li class="level2"><a href="#autotoc_md10">Running the client</a></li>
<li class="level2"><a href="#autotoc_md11">Connecting to the Gateway</a></li>
<li class="level2"><a href="#autotoc_md12">Subscribing to the topic</a></li>
<li class="level2"><a href="#autotoc_md13">Publishing to a topic</a></li>
<li class="level2"><a href="#autotoc_md14">Disconnecting and exiting</a></li>
</ul>
</li>
<li class="level1"><a href="#autotoc_md15">Troubleshooting</a></li>
</ul>
</div>
<div class="textblock"><p><b>This tutorial might not work as since 2025 the <a href="https://github.com/simon622/mqtt-sn">MQTT For Small Things (SN)</a> project has issues with online service support.</b> We recommend to follow this tutorial: <a class="el" href="mqttsn_gateway_setup_hivemq_edge.html">MQTT-SN Gateway setup using HiveMQ Edge</a> instead.</p>
<p>This is a simple tutorial showing how to set up a MQTT-SN gateway using <a href="https://github.com/simon622/mqtt-sn">MQTT For Small Things (SN) written in Java</a>.</p>
<p>This step is usually needed if you want to use the <a href="https://embe.net/docs/?q=doxyview/embeNET%20MQTT-SN%20Client">MQTT-SN client for embeNET</a>.</p>
<h1><a class="anchor" id="autotoc_md6"></a>
Introduction</h1>
<p>In this simple tutorial we will set up the MQTT-SN Gateway. This gateway is a software service written in Java by <a href="https://github.com/simon622">Simon Johnson</a>. This service allows to translate the UDP-based MQTT-SN communication to a standard TCP-based MQTT protocol. The job of the gateway is to connect MQTT-SN enabled clients to a standard MQTT broker. The software is distributed using Apache License.</p>
<h1><a class="anchor" id="autotoc_md7"></a>
Step 1: Download and run the gateway software</h1>
<p>You can download a released JAVA binary of MQTT-SN gateway from <a href="https://github.com/simon622/mqtt-sn/releases">github</a>. At the time of writing this tutorial the current version is 0.2.2 and the filename to download is <em>mqtt-sn-gateway-console-0.2.2.jar</em>. This is what we will use in this example. In order to run the software you need the Java Runtime Environment (JRE) but this is most likely already present in your system.</p>
<p>Once downloaded you can run the JAR file via commandline, giving two arguments:</p><ul>
<li>local udp port number for MQTT-SN clients</li>
<li>gatewayId, which is a string identifying the gateway</li>
</ul>
<div class="fragment"><div class="line">java -jar mqtt-sn-gateway-console-0.2.2.jar 1885 myGateway</div>
</div><!-- fragment --><p>The port number denotes a port that will be open for incomming MQTT-SN traffic from clients.</p>
<p>Once started the gateway can be accessed through a web inteface at default port 8080. Open the <a href="http://localhost:8080">http://localhost:8080</a> URL and you should see the web interface. The default username and password is <em>admin / password</em>.</p>
<p>Once logged into the Gateway's web inteface you can view several statistics concerning traffic, clients, topics etc.</p>
<div class="image">
<img src="gateway_setup01.png" alt=""/>
</div>
<h1><a class="anchor" id="autotoc_md8"></a>
Step 2: Configure the gateway</h1>
<p>We will now configure the connection with the MQTT broker. To do that go to the <em>MQTT Connectors</em> panel and press the <em>Start</em> button on the <em>Custom MQTT Broker</em> tile:</p>
<div class="image">
<img src="gateway_setup02.png" alt=""/>
</div>
<p>In the pop up window fill in the connection details. Here we will use a popular mosquitto test broker avaliable at <a href="https://test.mosquitto.org">test.mosquitto.org</a>.</p>
<div class="image">
<img src="gateway_setup03.png" alt=""/>
</div>
<p>Note that we are using port number <em>1884</em> which allows for unencrypted but authenticated access (more details <a href="https://test.mosquitto.org">here</a>).</p>
<p>If we've got it right then clicking <em>Yes, start the connector</em> should stop the default loopback connector and connect us to the mosquitto broker. This will be incicated by following sign:</p>
<div class="image">
<img src="gateway_setup04.png" alt=""/>
</div>
<h1><a class="anchor" id="autotoc_md9"></a>
Step 3: Verify the gateway (optional)</h1>
<p>There are may ways you may verify that the MQTT-SN Gateway is running. We will use the client tool distributed alongside the gateway. You can download a released JAVA binary of MQTT-SN client from <a href="https://github.com/simon622/mqtt-sn/releases">github</a>. At the time of writing this tutorial the current version is 0.2.2 and the filename to download is <em>mqtt-sn-client-0.2.2.jar</em>.</p>
<h2><a class="anchor" id="autotoc_md10"></a>
Running the client</h2>
<p>Once downloaded run the client application it like this: </p><div class="fragment"><div class="line">java -jar mqtt-sn-client-0.2.2.jar</div>
</div><!-- fragment --><p> Next give the details about the running Gateway.</p>
<ul>
<li>remote hostName or ip address : <b>localhost</b></li>
<li>remote port: <b>1885</b></li>
<li>client Id: <b>testclient</b> (whatever)</li>
<li>protocol version: <b>1</b> (we will use version 1.2)</li>
</ul>
<p>You should see the following output: </p><div class="fragment"><div class="line">        &gt;&gt; Starting up interactive CLI with clientId=testclient</div>
<div class="line">        &gt;&gt; Creating runtime with codec version.. 1</div>
<div class="line">        &gt;&gt; Using security service.. org.slj.mqtt.sn.impl.MqttsnSecurityService</div>
<div class="line">        &gt;&gt; Creating runtime .. DONE</div>
<div class="line">        &gt;&gt; console messaging output enabled</div>
<div class="line">        &gt;&gt; Adding runtime listeners.. DONE</div>
<div class="line">        &gt;&gt; Adding traffic listeners.. DONE</div>
<div class="line">        &gt;&gt; Runtime successfully initialised.</div>
<div class="line">Please enter a command (or type HELP) :</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md11"></a>
Connecting to the Gateway</h2>
<p>Type <b>CONNECT</b>, press ENTER and provide the following answers:</p><ul>
<li>clean session : <b>yes</b></li>
<li>keepAlive (in seconds): <b>60</b></li>
</ul>
<p>You should see the following output: </p><div class="fragment"><div class="line">&gt;&gt; DONE - connect issued successfully, client is connected</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md12"></a>
Subscribing to the topic</h2>
<p>Type <b>SUBSCRIBE</b>, press ENTER and provide the following answers:</p><ul>
<li>topic to subscribe to : <b>state</b> (or any other topic)</li>
<li>QoS: <b>0</b></li>
</ul>
<p>You should see the following output: </p><div class="fragment"><div class="line">&gt;&gt; DONE - subscribe issued successfully</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md13"></a>
Publishing to a topic</h2>
<p>Type <b>PUBLISH</b>, press ENTER and provide the following answers:</p><ul>
<li>topic to publish to: <b>ledControl</b></li>
<li>QoS: <b>0</b></li>
<li>retained publish: <b>no</b></li>
<li>message: <b>LEDON</b></li>
</ul>
<p>You should see the following output: </p><div class="fragment"><div class="line">&gt;&gt; ** message queued for sending</div>
<div class="line">** [&lt;&lt;&lt;] Publish sent [5] bytes on [ledControl] to [testclient] &quot;LEDON&quot;</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md14"></a>
Disconnecting and exiting</h2>
<p>Simply type <b>DISCONNECT</b> and <b>EXIT</b></p>
<h1><a class="anchor" id="autotoc_md15"></a>
Troubleshooting</h1>
<p>We've found that the MQTT-SN Gateway may fail to run again if not closed properly. In such case delete the <em>mqtt-sn-runtimes</em> folder the application creates and restart. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Sat Feb 1 2025 17:52:12 for embeNET MQTT-SN Client by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
